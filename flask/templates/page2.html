<!DOCTYPE html>
<html>
<head>
    <title> ì˜ ë„ì°©í–ˆì§€ë¡± ğŸŒˆ </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    
    <style>
        body {
            display: flex; /* Flex ì»¨í…Œì´ë„ˆë¡œ ì„¤ì • */
            flex-direction: column;
            justify-content: center; /* ê°€ë¡œ ê°€ìš´ë° ì •ë ¬ */
            align-items: center; /* ì„¸ë¡œ ê°€ìš´ë° ì •ë ¬ */
            background-image: url("{{ url_for('static', filename='background.png') }}");
            background-size: cover; /* ë°°ê²½ ì´ë¯¸ì§€ë¥¼ í™”ë©´ì— ë§ê²Œ ì¡°ì ˆ */
            background-repeat: no-repeat; /* ë°°ê²½ ì´ë¯¸ì§€ë¥¼ ë°˜ë³µí•˜ì§€ ì•ŠìŒ */
            background-position: center; /* ë°°ê²½ ì´ë¯¸ì§€ë¥¼ ê°€ìš´ë°ë¡œ ì •ë ¬ */
            background-attachment: fixed;
        }
        .matrix {
            display: block;
            margin-bottom: 20px;
        }
        .category {
            background-color: rgba(255,255,255,0.7);
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
        }
        .subcategory {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
        }
        tbody {
        border: 2px solid #dee2e6;
        }

        /* í…Œì´ë¸” ë¨¸ë¦¬ê¸€ì˜ í…Œë‘ë¦¬ ë‘ê»˜ë¥¼ 2pxë¡œ ì¡°ì ˆ */
        thead {
        border: 2px solid #dee2e6;
        }
        th.new_region, td.new_region {
            display: none;
        }
    </style>
</head>
<body>
    <h1> ì˜ ë„ì°©í–ˆì§€ë¡± ğŸŒˆ </h1>
    <h3>ì—¬í–‰ ê¸°ê°„: {{ ' ~ '.join(date_range) }}</h3>

    <div class="matrix">
        <div class="category">
            {% if one_way_or_round == 'ì™•ë³µ' %}
            <h3>í•­ê³µê¶Œ - ì™•ë³µ</h3>
            {% else %}
            <h3>í•­ê³µê¶Œ - í¸ë„</h3>
            {% endif %}
            <div class="subcategory", name="í•­ê³µê¶Œ_to">
                <h4>ê°€ëŠ” í¸</h4>
                <table class="table text-center">
                    <thead class="table-light">
                        <tr>
                            {% if data['í•­ê³µê¶Œ_to']|length > 0 %}
                            <th name="ì„ íƒ" class="í•­ê³µê¶Œ_to {{ key }}">ì„ íƒ</th>
                            {% for key in data['í•­ê³µê¶Œ_to'][0].keys() %}
                            <th name="{{ key }}" class="í•­ê³µê¶Œ_to {{ key }}">{{ key }}</th>
                            {% endfor %}
                            {% endif %}
                        </tr>
                    </thead>
                    <tbody>
                        {% if data['í•­ê³µê¶Œ_to']|length > 0 %}
                        {% for item in data['í•­ê³µê¶Œ_to'] %}
                        <tr>
                            <td name="ì„ íƒ" class="í•­ê³µê¶Œ_to {{ key }}">
                                {% if loop.index == 1 %}
                                <input type="radio" id="í•­ê³µê¶Œ_to{{ loop.index }}" name="í•­ê³µê¶Œ_to" value="{{ item }}" checked>
                                {% else %}
                                <input type="radio" id="í•­ê³µê¶Œ_to{{ loop.index }}" name="í•­ê³µê¶Œ_to" value="{{ item }}">
                                {% endif %}
                            </td>
                            {% for key, value in item.items() %}
                            <td name="{{ key }}" class="í•­ê³µê¶Œ_to {{ key }}">{{ value }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        {% endif %}
                    </tbody>
                </table>
            </div>
            <div class="subcategory", name="í•­ê³µê¶Œ_from">
                {% if data['í•­ê³µê¶Œ_from']|length > 0 %}
                <h4>ì˜¤ëŠ” í¸</h4>
                <table class="table text-center">
                    <thead class="table-light">
                        <tr>
                            <th name="ì„ íƒ" class="í•­ê³µê¶Œ_from {{ key }}">ì„ íƒ</th>
                            {% for key in data['í•­ê³µê¶Œ_from'][0].keys() %}
                            <th name="{{ key }}" class="í•­ê³µê¶Œ_from {{ key }}">{{ key }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {% if data['í•­ê³µê¶Œ_from']|length > 0 %}
                        {% for item in data['í•­ê³µê¶Œ_from'] %}
                        <tr>
                            <td name="ì„ íƒ" class="í•­ê³µê¶Œ_from {{ key }}">
                                {% if loop.index == 1 %}
                                <input type="radio" id="í•­ê³µê¶Œ_from{{ loop.index }}" name="í•­ê³µê¶Œ_from" value="{{ item }}" checked>
                                {% else %}
                                <input type="radio" id="í•­ê³µê¶Œ_from{{ loop.index }}" name="í•­ê³µê¶Œ_from" value="{{ item }}">
                                {% endif %}
                            </td>
                            {% for key, value in item.items() %}
                            <td name="{{ key }}" class="í•­ê³µê¶Œ_from {{ key }}">{{ value }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        {% endif %}
                    </tbody>
                </table>
                {% endif %}
            </div>
        </div>
        <div class="category", name="í˜¸í…”">
            <h3>ìˆ™ë°•ì‹œì„¤</h3>
            <table class="table text-center">
                <thead class="table-light">
                    <tr>
                        {% if data['í˜¸í…”']|length > 0 %}
                        <th name="ì„ íƒ" class="í˜¸í…” {{ key }}">ì„ íƒ</th>
                        {% for key in data['í˜¸í…”'][0].keys() %}
                        <th name="{{ key }}" class="í˜¸í…” {{ key }}">{{ key }}</th>
                        {% endfor %}
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% if data['í˜¸í…”']|length > 0 %}
                    {% for item in data['í˜¸í…”'] %}
                    {% set parent_loop = loop %}
                    <tr>
                        <td name="ì„ íƒ" class="í˜¸í…” {{ key }}">
                            {% if loop.index == 1 %}
                            <input type="radio" id="í˜¸í…”{{ loop.index }}" name="í˜¸í…”" value="{{ item }}" checked>
                            {% else %}
                            <input type="radio" id="í˜¸í…”{{ loop.index }}" name="í˜¸í…”" value="{{ item }}">
                            {% endif %}
                        </td>
                        {% for key, value in item.items() %}
                        <td name="{{ key }}" class="í˜¸í…” {{ key }}" id="í˜¸í…”{{ parent_loop.index }}-{{ key }}">{{ value }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                    {% endif %}
                </tbody>
            </table>
        </div>
        <div class="category", name="ë ŒíŠ¸ì¹´">
            <h3>ë Œí„°ì¹´</h3>
            <table class="table text-center">
                <thead class="table-light">
                    <tr>
                        {% if data['ë ŒíŠ¸ì¹´']|length > 0 %}
                        <th name="ì„ íƒ" class="ë ŒíŠ¸ì¹´ {{ key }}">ì„ íƒ</th>
                        {% for key in data['ë ŒíŠ¸ì¹´'][0].keys() %}
                        <th name="{{ key }}" class="ë ŒíŠ¸ì¹´ {{ key }}">{{ key }}</th>
                        {% endfor %}
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% if data['ë ŒíŠ¸ì¹´']|length > 0 %}
                    {% for item in data['ë ŒíŠ¸ì¹´'] %}
                    <tr>
                        <td name="ì„ íƒ" class="ë ŒíŠ¸ì¹´ {{ key }}">
                            {% if loop.index == 1 %}
                            <input type="radio" id="ë ŒíŠ¸ì¹´{{ loop.index }}" name="ë ŒíŠ¸ì¹´" value="{{ item }}" checked>
                            {% else %}
                            <input type="radio" id="ë ŒíŠ¸ì¹´{{ loop.index }}" name="ë ŒíŠ¸ì¹´" value="{{ item }}">
                            {% endif %}
                        </td>
                        {% for key, value in item.items() %}
                        <td name="{{ key }}" class="ë ŒíŠ¸ì¹´ {{ key }}">{{ value }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                    <tr>
                        <td name="ì„ íƒ" class="ë ŒíŠ¸ì¹´ {{ key }}">
                            <input type="radio" id="ë ŒíŠ¸ì¹´uncheck" name="ë ŒíŠ¸ì¹´" value='{{ "{}" }}'>
                        </td>
                        {% for i in range(data['ë ŒíŠ¸ì¹´'][0] | length) %}
                        {% if i == 0 %}
                        <td class="ë ŒíŠ¸ì¹´ {{ key }}">ë¯¸ì„ íƒ</td>
                        {% else %}
                        <td class="ë ŒíŠ¸ì¹´ {{ key }}"></td>
                        {% endif %}
                        {% endfor %}
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    <button class="submit" onclick="submit()">ì„ íƒì™„ë£Œ</button>

    <form id="myForm" method="get" style="display: none;" action="/3í˜ì´ì§€">
        <input type="text" name="input_data" id="inputData">
        <input type="text" name="date_range" id="dateRange">
        <input type="text" name="region" id="region">
        <input type="text" name="new_region" id="new_region">
    </form>

    <script>
        function submit() {
            const selectedItems = {};
            let region = null;
            let new_region = null;
            var categories = ['í•­ê³µê¶Œ_to', 'í•­ê³µê¶Œ_from', 'í˜¸í…”', 'ë ŒíŠ¸ì¹´'];
            for (var i = 0; i < categories.length; i++) {
                var radios = document.getElementsByName(categories[i]);
                for (var j = 0; j < radios.length; j++) {
                    var radio = radios[j];
                    if (radio.checked) {
                        selectedItems[categories[i]] = radio.value;
                        if (categories[i] == 'í˜¸í…”'){
                            region = document.getElementById(`${categories[i]}${j}-ì§€ì—­`).textContent
                            new_region = document.getElementById(`${categories[i]}${j}-new_region`).textContent
                        }
                        break;
                    }
                }
            }
            document.getElementById("inputData").value = JSON.stringify(selectedItems);
            document.getElementById("dateRange").value = "{{ date_range }}"
            document.getElementById('region').value = region
            document.getElementById('new_region').value = new_region
            document.getElementById("myForm").submit();
        }
    </script>
</body>
</html>
